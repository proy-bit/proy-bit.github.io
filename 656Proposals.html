document.getElementById('propuestaForm').addEventListener('submit', function(e) {
    e.preventDefault();
    var nombre = document.getElementById('nombre').value;
    var propuesta = document.getElementById('propuesta').value;

    // Validación básica de la propuesta
    if (!propuesta.trim()) {
        alert('Por favor, escribe una propuesta válida.');
        return;
    }

    // Realizamos la solicitud al backend para enviar el correo
    fetch('https://api.emailjs.com/api/v1.0/email/send', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            service_id: 'service_xcxd6mu',
            template_id: 'template_tmk2b7p',
            user_id: 'O2RwGslfhB17kpP_U',
            template_params: {
                nombre: nombre,
                propuesta: propuesta
            }
        })
    })
    .then(response => {
        if (response.ok) {
            // Ocultar el formulario y el contenedor
            document.getElementById('formContainer').style.display = 'none';
            // Mostrar el mensaje de éxito
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
        } else {
            throw new Error('Hubo un error al enviar la propuesta');
        }
    })
    .catch(error => {
        // Mostrar mensaje de error y ocultar formulario y contenedor
        document.getElementById('errorMessage').style.display = 'block';
        document.getElementById('formContainer').style.display = 'none';
        document.getElementById('successMessage').style.display = 'none';
    });
});

// Botón para enviar otra propuesta
document.getElementById('anotherProposalButton').addEventListener('click', function() {
    // Mostrar de nuevo el contenedor y el formulario, y ocultar el mensaje de éxito
    document.getElementById('formContainer').style.display = 'block';
    document.getElementById('successMessage').style.display = 'none';
    // Limpiar los campos del formulario
    document.getElementById('nombre').value = '';
    document.getElementById('propuesta').value = '';
});

// Botón para reintentar el envío de la propuesta
document.getElementById('retryButton').addEventListener('click', function() {
    // Mostrar el formulario y el contenedor, y ocultar el mensaje de error
    document.getElementById('formContainer').style.display = 'block';
    document.getElementById('errorMessage').style.display = 'none';
    // Limpiar los campos del formulario para reintentar
    document.getElementById('nombre').value = '';
    document.getElementById('propuesta').value = '';
});
